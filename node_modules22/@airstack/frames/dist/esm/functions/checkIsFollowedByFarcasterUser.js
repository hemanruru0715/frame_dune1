import { fetchQuery } from "@airstack/node";
import { checkIsFollowedByFarcasterUserQuery as query } from "../graphql/query/checkIsFollowedByFarcasterUser.query";
/**
 * @description Check If a Farcaster user of a given FID is followed by an array of Farcaster users with certain FIDs.
 * @example
 * const { data, error } = await checkIsFollowedByFarcasterUser({
 *  fid: 1,
 *  isFollowedBy: [2, 3, 4],
 * });
 * @param {Number} input.fid Farcaster user FID
 * @param {Array<Number>} input.isFollowedBy List of FIDs to check if the given user is followed by these list of Farcaster user with the provided FIDs
 * @returns List of the FID in `isFollowedBy` with true or false associated on the status of following or not
 */
export async function checkIsFollowedByFarcasterUser(input) {
    var _a, _b, _c;
    const { fid, isFollowedBy } = input !== null && input !== void 0 ? input : {};
    const variable = {
        identity: `fc_fid:${fid}`,
        isFollowedBy: isFollowedBy === null || isFollowedBy === void 0 ? void 0 : isFollowedBy.map((fid) => `fc_fid:${fid}`),
    };
    const { data, error } = await fetchQuery(query, variable);
    const { Following } = (_b = (_a = data === null || data === void 0 ? void 0 : data.Wallet) === null || _a === void 0 ? void 0 : _a.socialFollowings) !== null && _b !== void 0 ? _b : {};
    return {
        data: error
            ? null
            : (_c = isFollowedBy === null || isFollowedBy === void 0 ? void 0 : isFollowedBy.map((fid) => {
                var _a;
                return ({
                    fid,
                    isFollowedBy: (_a = (Following !== null && Following !== void 0 ? Following : [])) === null || _a === void 0 ? void 0 : _a.some((f) => {
                        var _a, _b;
                        return (_b = (_a = f === null || f === void 0 ? void 0 : f.followerAddress) === null || _a === void 0 ? void 0 : _a.farcaster) === null || _b === void 0 ? void 0 : _b.some((fc) => (fc === null || fc === void 0 ? void 0 : fc.fid) === fid.toString());
                    }),
                });
            })) !== null && _c !== void 0 ? _c : [],
        error,
    };
}
//# sourceMappingURL=checkIsFollowedByFarcasterUser.js.map